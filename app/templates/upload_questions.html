{% extends 'base.html' %}

{% block content %}
<h2>上传题目文件（进入待校验池）</h2>
<p class="text-muted">支持 PDF / Word(.docx) / TXT。系统会按题号与“答案/解析”关键字做启发式解析，导入后请到“待校验池”逐题确认与修正。</p>

<div class="card">
    <div class="card-body">
        <form method="POST" enctype="multipart/form-data">
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">选择文件</label>
                    <input type="file" name="file" class="form-control" accept=".pdf,.docx,.txt" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">创建人（可选）</label>
                    <input type="text" name="create_user" class="form-control" placeholder="例如：张老师">
                </div>

                <div class="col-md-3">
                    <label class="form-label">默认科目</label>
                    <select name="subject_id" class="form-select">
                        {% for s in subjects %}
                        <option value="{{ s.subject_id }}">{{ s.subject_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">默认题型</label>
                    <select name="type_id" class="form-select">
                        {% for t in types %}
                        <option value="{{ t.type_id }}">{{ t.type_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">默认难度</label>
                    <select name="difficulty_id" class="form-select">
                        {% for d in difficulties %}
                        <option value="{{ d.difficulty_id }}">{{ d.difficulty_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">默认分值</label>
                    <input type="number" name="score" class="form-control" value="5" step="0.5" min="0.5">
                </div>

                <div class="col-md-12">
                    <label class="form-label">默认章节ID（可选，建议导入后在待校验池逐题修改）</label>
                    <input type="number" name="chapter_id" class="form-control" value="1" min="1">
                </div>
            </div>

            <div class="mt-3 d-flex gap-2">
                <button type="submit" class="btn btn-primary">上传并解析</button>
                <a href="/questions" class="btn btn-secondary">返回题库</a>
            </div>
        </form>
    </div>
</div>

<div class="alert alert-info mt-3">
    <strong>解析建议：</strong>
    <ul class="mb-0">
        <li>题号格式尽量使用：<code>1.</code> / <code>1、</code> / <code>(1)</code> / <code>（1）</code></li>
        <li>答案/解析尽量使用：<code>答案：</code>、<code>参考答案：</code>、<code>解析：</code></li>
    </ul>
</div>
{% endblock %}

